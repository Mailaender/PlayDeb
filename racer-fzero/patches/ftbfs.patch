# fix libbullet 2.81 compatibility
# add size_t namespace.
Index: racer-fzero-0.0.320/libtrack/document/MoveNodeDelta.h
===================================================================
--- racer-fzero-0.0.320.orig/libtrack/document/MoveNodeDelta.h	2013-11-15 20:05:38.537640110 +0100
+++ racer-fzero-0.0.320/libtrack/document/MoveNodeDelta.h	2013-11-15 20:05:38.525640110 +0100
@@ -15,6 +15,7 @@
 #include "ChangePropertyDelta.h"
 
 #include <LinearMath/btVector3.h>
+#include <cstddef>
 
 namespace Document
 {
Index: racer-fzero-0.0.320/libtrack/document/MoveTrackAttachmentDelta.h
===================================================================
--- racer-fzero-0.0.320.orig/libtrack/document/MoveTrackAttachmentDelta.h	2013-11-15 20:05:38.537640110 +0100
+++ racer-fzero-0.0.320/libtrack/document/MoveTrackAttachmentDelta.h	2013-11-15 20:05:38.525640110 +0100
@@ -15,6 +15,7 @@
 #include "ChangePropertyDelta.h"
 
 #include <LinearMath/btVector3.h>
+#include <cstddef>
 
 namespace Document
 {
Index: racer-fzero-0.0.320/racer/Engine/GameObjects/Car.cpp
===================================================================
--- racer-fzero-0.0.320.orig/racer/Engine/GameObjects/Car.cpp	2013-11-15 20:05:38.537640110 +0100
+++ racer-fzero-0.0.320/racer/Engine/GameObjects/Car.cpp	2013-11-15 20:05:38.525640110 +0100
@@ -37,23 +37,24 @@
  */
 
 void contact_added_callback_obj (btManifoldPoint& cp,
-                                 const btCollisionObject* colObj,
+                                 const btCollisionObjectWrapper* col,
                                  int partId, int index)
 {
         (void) partId;
         (void) index;
-        const btCollisionShape *shape = colObj->getCollisionShape();
+	const btCollisionObject* obj = col->getCollisionObject();
+        const btCollisionShape *shape = col->getCollisionShape();
 
         if (shape->getShapeType() != TRIANGLE_SHAPE_PROXYTYPE) return;
         const btTriangleShape *tshape =
-               static_cast<const btTriangleShape*>(colObj->getCollisionShape());
+               static_cast<const btTriangleShape*>(col->getCollisionShape());
 
 
-        const btCollisionShape *parent = colObj->getRootCollisionShape();
+        const btCollisionShape *parent = obj->getCollisionShape();
         if (parent == NULL) return;
         if (parent->getShapeType() != TRIANGLE_MESH_SHAPE_PROXYTYPE) return;
 
-        btTransform orient = colObj->getWorldTransform();
+        btTransform orient = col->getWorldTransform();
         orient.setOrigin( btVector3(0.0f,0.0f,0.0f ) );
 
         btVector3 v1 = tshape->m_vertices1[0];
@@ -73,13 +74,13 @@
 }
 
 bool contact_added_callback (btManifoldPoint& cp,
-                             const btCollisionObject* colObj0,
+                             const btCollisionObjectWrapper* col0,
                              int partId0, int index0,
-                             const btCollisionObject* colObj1,
+                             const btCollisionObjectWrapper* col1,
                              int partId1, int index1)
 {
-        contact_added_callback_obj(cp, colObj0, partId0, index0);
-        contact_added_callback_obj(cp, colObj1, partId1, index1);
+        contact_added_callback_obj(cp, col0, partId0, index0);
+        contact_added_callback_obj(cp, col1, partId1, index1);
         //std::cout << to_ogre(cp.m_normalWorldOnB) << std::endl;
         return true;
 }
Index: racer-fzero-0.0.320/racer/Engine/GameObjects/Car.h
===================================================================
--- racer-fzero-0.0.320.orig/racer/Engine/GameObjects/Car.h	2013-11-15 20:05:38.537640110 +0100
+++ racer-fzero-0.0.320/racer/Engine/GameObjects/Car.h	2013-11-15 20:05:38.525640110 +0100
@@ -24,6 +24,7 @@
 
 namespace Engine
 {
+    struct btCollisionObjectWrapper;
     class InputDevice;
 
 /// Objects which affect the gameplay.
Index: racer-fzero-0.0.320/configure.ac
===================================================================
--- racer-fzero-0.0.320.orig/configure.ac	2013-11-15 20:05:38.537640110 +0100
+++ racer-fzero-0.0.320/configure.ac	2013-11-15 20:05:38.533640110 +0100
@@ -52,7 +52,7 @@
 AC_SUBST(racer_partial_LIBS)
 AC_SUBST(racer_partial_CFLAGS)
 AC_SUBST(racer_CFLAGS, ["$EXTRA_CFLAGS $SDL_CFLAGS $racer_partial_CFLAGS"])
-AC_SUBST(racer_LIBS, ["$SDL_LIBS $racer_partial_LIBS -lSDL_image -lGLEW"])
+AC_SUBST(racer_LIBS, ["$SDL_LIBS $racer_partial_LIBS -lSDL_image -lGLEW -lGLU"])
 #old versions of FTGL use different headers.
 PKG_CHECK_EXISTS(ftgl >= 2.1.3,
   [AC_DEFINE(HAVE_FTGL_2_1_3, [1], [Defined if ftgl is at least version 2.1.3])],
