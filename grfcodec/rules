#!/usr/bin/make -f
# -*- makefile -*-

# Use debhelper default for all targets (but some are overridden below).
%:
	dh $@

# Don't use dh for clean. Since the upstream Makefile generates
# dependency information before any error messages, dh_auto_clean
# sometimes thinks make distclean is supported, while it isn't. Instead,
# we use make mrproper, which does something similar.
override_dh_auto_clean:
	make mrproper
	# Remove files autogenerated by make, but not removed by make
	# mrproper.
	rm -f Makefile.local

override_dh_auto_configure:
	# Default is to install to /usr/local
	#echo "INSTALLPATH_LINUX=debian/grfcodec/usr/bin" >> Makefile.local
	echo "prefix=/usr" >> Makefile.local
	# Disable UPX binary compression, it is not available on all
	# platforms.
	echo "UPX=" >> Makefile.local

override_dh_auto_install:
	dh_auto_install
	# Remove the changelog, dh_installchangelogs will do that as
	# well.
	rm debian/tmp/usr/share/doc/grfcodec/changelog.txt
	# Remove the COPYING file, it's just a verbatim GPL copy
	rm debian/tmp/usr/share/doc/grfcodec/COPYING

override_dh_install:
	dh_install --fail-missing
